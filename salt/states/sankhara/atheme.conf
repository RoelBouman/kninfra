loadmodule "modules/protocol/inspircd12";
loadmodule "modules/backend/opensex";
loadmodule "modules/crypto/posix";
#loadmodule "modules/auth/ldap";
loadmodule "modules/nickserv/main";
#loadmodule "modules/nickserv/access";
loadmodule "modules/nickserv/badmail";
#loadmodule "modules/nickserv/cert";
#loadmodule "modules/nickserv/cracklib";
loadmodule "modules/nickserv/drop";
#loadmodule "modules/nickserv/enforce";
loadmodule "modules/nickserv/ghost";
loadmodule "modules/nickserv/group";
loadmodule "modules/nickserv/help";
loadmodule "modules/nickserv/hold";
loadmodule "modules/nickserv/identify";
loadmodule "modules/nickserv/info";
loadmodule "modules/nickserv/list";
loadmodule "modules/nickserv/listmail";
#loadmodule "modules/nickserv/listownmail";
#loadmodule "modules/nickserv/login";
loadmodule "modules/nickserv/logout";
loadmodule "modules/nickserv/mark";
loadmodule "modules/nickserv/freeze";
loadmodule "modules/nickserv/listchans";
loadmodule "modules/nickserv/register";
loadmodule "modules/nickserv/regnolimit";
loadmodule "modules/nickserv/resetpass";
loadmodule "modules/nickserv/return";
loadmodule "modules/nickserv/setpass";
#loadmodule "modules/nickserv/sendpass";
loadmodule "modules/nickserv/sendpass_user";
loadmodule "modules/nickserv/set_core";
loadmodule "modules/nickserv/set_accountname";
loadmodule "modules/nickserv/set_email";
loadmodule "modules/nickserv/set_emailmemos";
#loadmodule "modules/nickserv/set_enforcetime";
loadmodule "modules/nickserv/set_hidemail";
loadmodule "modules/nickserv/set_language";
loadmodule "modules/nickserv/set_neverop";
loadmodule "modules/nickserv/set_nomemo";
loadmodule "modules/nickserv/set_noop";
loadmodule "modules/nickserv/set_password";
#loadmodule "modules/nickserv/set_privmsg";
#loadmodule "modules/nickserv/set_private";
loadmodule "modules/nickserv/set_property";
loadmodule "modules/nickserv/set_quietchg";
#loadmodule "modules/nickserv/subscribe";
loadmodule "modules/nickserv/status";
loadmodule "modules/nickserv/taxonomy";
loadmodule "modules/nickserv/vacation";
loadmodule "modules/nickserv/verify";
loadmodule "modules/nickserv/vhost";
loadmodule "modules/chanserv/main";
loadmodule "modules/chanserv/access";
loadmodule "modules/chanserv/akick";
loadmodule "modules/chanserv/ban";
#loadmodule "modules/chanserv/unban_self";
loadmodule "modules/chanserv/close";
loadmodule "modules/chanserv/clear";
loadmodule "modules/chanserv/clear_bans";
loadmodule "modules/chanserv/clear_flags";
loadmodule "modules/chanserv/clear_users";
loadmodule "modules/chanserv/count";
loadmodule "modules/chanserv/drop";
#loadmodule "modules/chanserv/fflags";
loadmodule "modules/chanserv/flags";
loadmodule "modules/chanserv/ftransfer";
loadmodule "modules/chanserv/getkey";
#loadmodule "modules/chanserv/halfop";
loadmodule "modules/chanserv/help";
loadmodule "modules/chanserv/hold";
loadmodule "modules/chanserv/info";
loadmodule "modules/chanserv/invite";
loadmodule "modules/chanserv/kick";
loadmodule "modules/chanserv/list";
loadmodule "modules/chanserv/mark";
loadmodule "modules/chanserv/op";
#loadmodule "modules/chanserv/owner";
#loadmodule "modules/chanserv/protect";
#loadmodule "modules/chanserv/quiet";
loadmodule "modules/chanserv/recover";
loadmodule "modules/chanserv/register";
loadmodule "modules/chanserv/set_core";
loadmodule "modules/chanserv/set_email";
loadmodule "modules/chanserv/set_entrymsg";
loadmodule "modules/chanserv/set_fantasy";
loadmodule "modules/chanserv/set_founder";
#loadmodule "modules/chanserv/set_gameserv";
loadmodule "modules/chanserv/set_guard";
loadmodule "modules/chanserv/set_keeptopic";
#loadmodule "modules/chanserv/set_limitflags";
loadmodule "modules/chanserv/set_mlock";
loadmodule "modules/chanserv/set_prefix";
#loadmodule "modules/chanserv/set_private";
loadmodule "modules/chanserv/set_property";
loadmodule "modules/chanserv/set_restricted";
loadmodule "modules/chanserv/set_secure";
loadmodule "modules/chanserv/set_topiclock";
loadmodule "modules/chanserv/set_url";
loadmodule "modules/chanserv/set_verbose";
loadmodule "modules/chanserv/status";
#loadmodule "modules/chanserv/successor_acl";
loadmodule "modules/chanserv/taxonomy";
loadmodule "modules/chanserv/template";
loadmodule "modules/chanserv/topic";
loadmodule "modules/chanserv/voice";
loadmodule "modules/chanserv/why";
#loadmodule "modules/chanserv/xop";
loadmodule "modules/operserv/main";
loadmodule "modules/operserv/akill";
#loadmodule "modules/operserv/clearchan";
#loadmodule "modules/operserv/clones";
loadmodule "modules/operserv/compare";
#loadmodule "modules/operserv/greplog";
loadmodule "modules/operserv/help";
loadmodule "modules/operserv/identify";
loadmodule "modules/operserv/ignore";
loadmodule "modules/operserv/info";
loadmodule "modules/operserv/jupe";
loadmodule "modules/operserv/mode";
loadmodule "modules/operserv/modinspect";
loadmodule "modules/operserv/modlist";
loadmodule "modules/operserv/modload";
loadmodule "modules/operserv/modunload";
loadmodule "modules/operserv/modreload";
loadmodule "modules/operserv/noop";
#loadmodule "modules/operserv/override";
#loadmodule "modules/operserv/rakill";
loadmodule "modules/operserv/readonly";
loadmodule "modules/operserv/rehash";
loadmodule "modules/operserv/restart";
loadmodule "modules/operserv/rmatch";
loadmodule "modules/operserv/rnc";
loadmodule "modules/operserv/rwatch";
loadmodule "modules/operserv/sgline";
loadmodule "modules/operserv/shutdown";
#loadmodule "modules/operserv/soper";
loadmodule "modules/operserv/specs";
loadmodule "modules/operserv/sqline";
loadmodule "modules/operserv/update";
loadmodule "modules/operserv/uptime";
loadmodule "modules/memoserv/main";
loadmodule "modules/memoserv/help";
loadmodule "modules/memoserv/send";
loadmodule "modules/memoserv/sendops";
loadmodule "modules/memoserv/sendgroup";
loadmodule "modules/memoserv/list";
loadmodule "modules/memoserv/read";
loadmodule "modules/memoserv/forward";
loadmodule "modules/memoserv/delete";
loadmodule "modules/memoserv/ignore";
loadmodule "modules/global/main";
loadmodule "modules/infoserv/main";
#loadmodule "modules/gameserv/main";
#loadmodule "modules/gameserv/dice";
#loadmodule "modules/gameserv/help";
#loadmodule "modules/gameserv/namegen";
#loadmodule "modules/botserv/main";
#loadmodule "modules/botserv/help";
#loadmodule "modules/botserv/info";
#loadmodule "modules/botserv/bottalk";
#loadmodule "modules/botserv/set_core";
#loadmodule "modules/botserv/set_fantasy";
#loadmodule "modules/botserv/set_nobot";
#loadmodule "modules/botserv/set_private";
#loadmodule "modules/hostserv/main";
#loadmodule "modules/hostserv/help";
#loadmodule "modules/hostserv/onoff";
#loadmodule "modules/hostserv/offer";
#loadmodule "modules/hostserv/request";
#loadmodule "modules/hostserv/vhost";
#loadmodule "modules/hostserv/vhostnick";
#loadmodule "modules/hostserv/group";
#loadmodule "modules/helpserv/main";
#loadmodule "modules/helpserv/helpme";
#loadmodule "modules/helpserv/ticket";
#loadmodule "modules/helpserv/services";
#loadmodule "modules/alis/main";
loadmodule "modules/groupserv/main";
#loadmodule "modules/misc/httpd";
#loadmodule "modules/xmlrpc/main";
#loadmodule "modules/contrib/ns_listlogins";

serverinfo {
	name = "services.{{ grains['fqdn'] }}";
	desc = "KN Atheme IRC Services";
	numeric = "00A";
	recontime = 10;
	netname = "Karpe Noktem IRC";
	hidehostsuffix = "users.misconfigured";
	adminname = "Weccie";
	adminemail = "webcie@{{ grains['fqdn'] }}";
	mta = "/usr/sbin/sendmail";
	loglevel = { error; info; admin; network; wallops; };
	maxlogins = 5;
	maxusers = 5;
	maxnicks = 5;
	maxchans = 5;
	mdlimit = 30;
	emaillimit = 10;
	emailtime = 300;
	auth = email;
	casemapping = rfc1459;
};

uplink "{{ grains['fqdn'] }}" {
	host = "127.0.0.1";
	password = "{{ pillar['secrets']['irc_services_secret'] }}";
	port = 7252;
};


nickserv {
	spam;
	#no_nick_ownership;
	nick = "NickServ";
	user = "NickServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Nickname Services";
	aliases {
		"ID" = "IDENTIFY";
		"MYACCESS" = "LISTCHANS";
	};

	expire = 30;
	#enforce_expire = 14;
	#enforce_delay = 30;
	#enforce_prefix = "Guest";
	#cracklib_dict = "/var/cache/cracklib/cracklib_dict";
	#cracklib_warn;
};

chanserv {
	nick = "ChanServ";
	user = "ChanServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Channel Services";
	aliases {
	};

	#fantasy;
	#hide_xop;
	templates {
		vop = "+VA";
		hop = "+vVhHtA";
		aop = "+vhoOtriA";
		sop = "+vhoOtrsifAa";
		founder = "+vhoOtrisifAaF";
		#member = "+iA";
		#op = "+voOtriA";
	};

	#deftemplates = "MEMBER=+iA OP=+voOtriA";
	#changets;
	trigger = "!";
	expire = 30;
	maxchanacs = 0;
	maxfounders = 4;
};

global {
	nick = "Global";
	user = "Global";
	host = "services.{{ grains['fqdn'] }}";
	real = "Network Announcements";
};

infoserv {
	nick = "InfoServ";
	user = "InfoServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Information Service";
	logoninfo_count = 3;
};

operserv {
	nick = "OperServ";
	user = "OperServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Operator Services";
	aliases {
	};
};

memoserv {
	nick = "MemoServ";
	user = "MemoServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Memo Services";
	aliases {
	};
};

botserv {
	nick = "BotServ";
	user = "BotServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Bot Services";
	min_users = 0;
};

groupserv {
	nick = "GroupServ";
	user = "GroupServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Group Managment Services";
	aliases {
	};

	maxgroups = 5;
	maxgroupacs = 100;
	enable_open_groups;
};

hostserv {
	nick = "HostServ";
	user = "HostServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Host Management Services";
	#request_per_nick;
	aliases {
		"APPROVE" = "ACTIVATE";
		"DENY" = "REJECT";
	};
};

helpserv {
	nick = "HelpServ";
	user = "HelpServ";
	host = "services.{{ grains['fqdn'] }}";
	real = "Help Services";
};

alis {
	nick = "ALIS";
	user = "alis";
	host = "services.{{ grains['fqdn'] }}";
	real = "Channel Directory";
};


#ldap {
#	url = "ldap://127.0.0.1";
#	dnformat = "cn=%s,dc=jillestest,dc=com";
#};

logfile "var/account.log" { register; set; };
logfile "var/commands.log" { commands; };
logfile "#services" { error; info; admin; request; register; };

general {
	#helpchan = "#help";
	#helpurl = "http://www.stack.nl/~jilles/irc/atheme-help/";
	#silent;
	#verbose_wallops;
	join_chans;
	leave_chans;
	#secure;
	uflags = { hidemail; };
	cflags = { verbose; guard; };
	#raw;
	flood_msgs = 7;
	flood_time = 10;
	ratelimit_uses = 5;
	ratelimit_period = 60;
	kline_time = 7;
	clone_time = 0;
	commit_interval = 5;
	default_clone_limit = 5;
	default_clone_allowed = 5;
	default_clone_warn = 4;
	uplink_sendq_limit = 1048576;
	language = "en";

	exempts {
	};

	#allow_taint;
	immune_level = immune;
};

operclass "ircop" {
	privs {
		special:ircop;
	};

	privs {
		user:auspex;
		user:admin;
		user:sendpass;
		user:vhost;
		user:mark;
	};

	privs {
		chan:auspex;
		chan:admin;
		chan:cmodes;
		chan:joinstaffonly;
	};

	privs {
		general:auspex;
		general:helper;
		general:viewprivs;
		general:flood;
	};

	privs {
		operserv:omode;
		operserv:akill;
		operserv:jupe;
		operserv:global;
	};

	privs {
		group:auspex;
		group:admin;
	};
};

operclass "sra" {
	extends "ircop";

	privs {
		user:hold;
		user:regnolimit;
	};

	privs {
		general:metadata;
		general:admin;
	};

	privs {
		#operserv:massakill;
		#operserv:akill-anymask;
		operserv:noop;
		operserv:grant;
		#operserv:override;
	};

	needoper;
};


operator "example" {
	operclass = "sra";
	#password = "$1$3gJMO9by$0G60YE6GqmuHVH3AnFPor1";
};
